<!DOCTYPE html>
<html lang="es">
<head>
  <!-- ========================================================= -->
  <!-- Ãguila Inventario Pro - App Shell Principal               -->
  <!-- Copyright Â© 2025 JosÃ© A. G. Betancourt                     -->
  <!-- ========================================================= -->

  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="theme-color" content="#004aad" />

  <title>ğŸ¦… Ãguila Inventario Pro</title>
  <meta name="description" content="Sistema profesional de inventario para promotores de tienda con escÃ¡ner y modo offline." />

  <!-- ======================= PWA ======================= -->
  <link rel="manifest" href="manifest.json" />
  <link rel="icon" href="assets/icon-192x192.png" sizes="192x192" />
  <link rel="apple-touch-icon" href="assets/icon-512x512.png" />

  <!-- ======================= ESTILOS ======================= -->
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="custom-styles.css" />

  <!-- ======================= FIREBASE SDK (COMPAT) ======================= -->
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

  <!-- ======================= CONFIG ======================= -->
  <script src="firebase-config.js"></script>
</head>

<body>

<!-- ========================================================= -->
<!-- OVERLAY SIDEBAR (MÃ“VIL)                                   -->
<!-- ========================================================= -->
<div id="sidebar-overlay"></div>

<!-- ========================================================= -->
<!-- SIDEBAR / MENÃš LATERAL                                   -->
<!-- ========================================================= -->
<aside id="sidebar">
  <div class="sidebar-header">
    <h2>ğŸ¦… Ãguila Pro</h2>
  </div>

  <nav class="sidebar-nav">
    <a href="#" data-tab="inventario" class="active">ğŸ“¦ Inventario</a>
    <a href="#" data-tab="agregar">â• Agregar</a>
    <a href="#" data-tab="relleno">ğŸ”„ Relleno</a>
    <a href="#" data-tab="auditoria">âœ“ AuditorÃ­a</a>
    <a href="#" data-tab="sistema">âš™ï¸ Sistema</a>
    <hr />
    <a href="#" id="btn-logout">ğŸšª Cerrar sesiÃ³n</a>
  </nav>
</aside>

<!-- ========================================================= -->
<!-- CONTENEDOR PRINCIPAL                                    -->
<!-- ========================================================= -->
<div class="app-container">

  <!-- ======================= HEADER ======================= -->
  <header class="app-header">
    <button id="menu-toggle">â˜°</button>
    <h1>Ãguila Inventario Pro</h1>

    <div class="status-indicator status-online">
      <span id="connection-status-text">Conectado</span>
    </div>
  </header>

  <!-- ======================= CONTENIDO ======================= -->
  <main class="app-main">

    <!-- ===================================================== -->
    <!-- TAB: INVENTARIO                                      -->
    <!-- ===================================================== -->
    <section id="tab-inventario" class="tab-content active">
      <h2>ğŸ“¦ Inventario</h2>

      <input
        type="text"
        id="inventory-search"
        placeholder="Buscar por nombre o cÃ³digo..."
      />

      <div id="inventory-container">
        <!-- inventory.js renderiza aquÃ­ -->
      </div>
    </section>

    <!-- ===================================================== -->
    <!-- TAB: AGREGAR PRODUCTO                                -->
    <!-- ===================================================== -->
    <section id="tab-agregar" class="tab-content hidden">
      <h2>â• Agregar Producto</h2>

      <button class="scanner-btn" data-scan-context="agregar">
        ğŸ“· Escanear cÃ³digo
      </button>

      <form id="form-agregar-producto">
        <input id="agregar-codigo" placeholder="CÃ³digo de barras" required />
        <input id="agregar-nombre" placeholder="Nombre del producto" required />
        <input id="agregar-marca" placeholder="Marca" required />
        <input id="agregar-piezas" type="number" placeholder="Piezas por caja" required />
        <input id="agregar-cajas" type="number" placeholder="Cajas" required />
        <input id="agregar-ubicacion" placeholder="Bodega / UbicaciÃ³n" required />
        <input id="agregar-caducidad" type="date" required />

        <button type="submit">ğŸ’¾ Guardar producto</button>
      </form>
    </section>

    <!-- ===================================================== -->
    <!-- TAB: RELLENO                                         -->
    <!-- ===================================================== -->
    <section id="tab-relleno" class="tab-content hidden">
      <h2>ğŸ”„ Relleno / Reabastecimiento</h2>

      <button class="scanner-btn" data-scan-context="relleno">
        ğŸ“· Escanear producto
      </button>

      <form id="form-relleno">
        <input id="relleno-codigo" placeholder="CÃ³digo de barras" required />
        <input id="relleno-nombre" placeholder="Nombre del producto" />
        <input id="relleno-marca" placeholder="Marca" />
        <input id="relleno-piezas" type="number" placeholder="Piezas por caja" />
        <input id="relleno-cajas" type="number" placeholder="Cajas movidas" required />
        <input id="relleno-caducidad" type="date" required />

        <button type="submit">ğŸ“¦ Registrar relleno</button>
      </form>
    </section>

    <!-- ===================================================== -->
    <!-- TAB: AUDITORÃA                                       -->
    <!-- ===================================================== -->
    <section id="tab-auditoria" class="tab-content hidden">
      <h2>âœ“ AuditorÃ­a</h2>

      <select id="audit-bodega-select">
        <option value="">Selecciona bodega</option>
      </select>

      <button class="scanner-btn" data-scan-context="auditoria">
        ğŸ“· Escanear producto
      </button>

      <div id="audit-list">
        <!-- audit.js renderiza aquÃ­ -->
      </div>
    </section>

    <!-- ===================================================== -->
    <!-- TAB: SISTEMA                                         -->
    <!-- ===================================================== -->
    <section id="tab-sistema" class="tab-content hidden">
      <h2>âš™ï¸ Sistema</h2>

      <div class="system-panel">
        <p>ğŸŒ Estado: <span id="system-connection-status"></span></p>
        <p>âš™ï¸ Service Worker: <span id="system-sw-status"></span></p>
        <p>â³ Operaciones pendientes: <span id="system-pending-ops"></span></p>
      </div>

      <button id="btn-diagnostico">ğŸ” DiagnÃ³stico</button>
      <button id="btn-stats">ğŸ“Š EstadÃ­sticas</button>
      <button id="btn-clear-data">ğŸ—‘ï¸ Limpiar datos locales</button>
    </section>

  </main>
</div>

<!-- ========================================================= -->
<!-- SCRIPTS (ORDEN CRÃTICO)                                  -->
<!-- ========================================================= -->

<!-- UI primero -->
<script src="ui.js"></script>

<!-- AutenticaciÃ³n -->
<script src="auth.js"></script>

<!-- LÃ³gica principal -->
<script src="app.js"></script>

<!-- Inventario -->
<script src="inventory.js"></script>
<script src="inventory-enhanced.js"></script>

<!-- Relleno y AuditorÃ­a -->
<script src="refill.js"></script>
<script src="audit.js"></script>

<!-- Sistema -->
<script src="system.js"></script>

<!-- EscÃ¡ner -->
<script src="scanner-mlkit.js"></script>
<script src="scanner-events.js"></script>

<!-- ========================================================= -->
<!-- SERVICE WORKER (PWA)                                     -->
<!-- ========================================================= -->
<script>
  if ('serviceWorker' in navigator) {
    navigator.serviceWorker.register('service-worker.js')
      .then(() => console.log('âœ… Service Worker registrado'))
      .catch(err => console.error('âŒ SW error', err));
  }
</script>

</body>
</html>